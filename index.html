<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>051824</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header">
        <h1 id="header">ilovebri</h1>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.3/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script>
        const Engine = Matter.Engine;
        const World = Matter.World;
        const Bodies = Matter.Bodies;
        const Body = Matter.Body;

        let engine;
        let items = [];
        let lastMouseX = 0;
        let lastMouseY = 0;

        let imgText = [
            "01.01.2024",
            "hot",
            "so cute", 
            "Happy Anniversary!!!",
            "05.17.2024",
            "12.25.2023",
            "10.08.2023",
            "10.08.2023",
            "05.08.2023",
            "10.15.2023 pumpkins!",
            "10.08.2023",
            "11.11.2023",
            "11.23.2023 christmas",
            "12.17.2023 cherry valley",
            "01.14.2024",
            "01.14.2024 museum",
            "01.14.2024",
            "01.14.2024 what am i lookin at?",
            "sick ass photo",
            "aw so cute",
            "basketcase hiking!!!",
            "04.01.2024 almond trail",
            "Happy Anniversary!",
            "yuhhh",
            "02.19.2024",
            "04.14.2024 stussy sale woahh",
            "04.04.2023 <3 4th of july",
            "03.19.2023 <3 old town orange date",
            "05.08.2023",
            "05.08.2023 when you put me on prince st pizza",
            "<3",
            "camp flog",
            "Happy Anniversary Baby",
            "05.27.2023",
            "05.29.2023",
            "12.09.2023 we onna cruise!",
            "02.06.2024",
            "12.17.2023",
            "01.14.2024 in line for xio long bao",
            "07.22.2023 pretty lookin for clouds",
            "damn",
            "08.06.2023 hard summa",
            "chúc mừng năm mới"
        ];

        function setup(){
            createCanvas(window.innerWidth, window.innerHeight);
            engine = Engine.create({ 
                enableSleeping: true, // Optimize physics engine to reduce calculations
                constraintIterations: 2, // Reduce constraint iterations for performance
                velocityIterations: 3, // Reduce velocity iterations for performance
                positionIterations: 3 // Reduce position iterations for performance
            });
            engine.world.gravity.y = 0;

            addBoundaries();
            noCursor();


            for (let i = 0; i < 3; i++){
                let x = random(100, width - 100);
                let y = random(100, height - 100);
                let randomImageNumber = getRandomNumber();
                let text = getTextForImage(randomImageNumber);
                items.push(new Item(x, y, `./assets/img${randomImageNumber}.jpg`, text))
            }         

            // Event listener for mouse click on the header
            document.getElementById("header").addEventListener("click", function() {
                resetItems();
            });
        }

        //function to reset items inside website
        function resetItems() {
            items.forEach((item) => {
                let randomImageNumber = getRandomNumber();
                let text = getTextForImage(randomImageNumber);
                item.updateImage(`./assets/img${randomImageNumber}.jpg`, text);
            });
        }

        //get random number
        function getRandomNumber() {
            return Math.floor(Math.random() * 43) + 1;
        }       

        function getTextForImage(imageNumber) {
            // Replace this with your logic to get text for each image
            return imgText[imageNumber-1];
        }

        function addBoundaries() {
            const thickness = 50;
            World.add(engine.world, [
                Bodies.rectangle(width / 2, -thickness / 2, width, thickness, {
                    isStatic: true,
                }),
                Bodies.rectangle(width / 2, height +thickness / 2, width, thickness, {
                    isStatic: true,
                }),
                Bodies.rectangle(-thickness / 2, height / 2, thickness, height, {
                    isStatic: true,
                }),
                Bodies.rectangle(width + thickness / 2, height / 2, thickness, height, {
                    isStatic: true,
                }),
            ])
        }

        function draw() {
            background("black");
            Engine.update(engine);
            items.forEach((item) => item.update());

            // Draw a white circle at the mouse position
            fill(255); // Set fill color to white
            ellipse(mouseX, mouseY, 40, 40); // Draw a white circle at the mouse position
        }

        class Item {
            constructor(x, y, imagePath, text){
                let options = {
                    frictionAir: 0.075,
                    restitution: 0.25,
                    density: 0.002,
                    angle: Math.random() + Math.PI * 2,
                };

                this.body = Bodies.rectangle(x, y, 100, 200, options);
                World.add(engine.world, this.body);

                this.div = document.createElement("div");
                this.div.className = "item";
                this.div.style.left = `${this.body.position.x - 50}px`;
                this.div.style.top = `${this.body.position.y - 100}px`;
                const img = document.createElement("img");
                img.src = imagePath;
                this.div.appendChild(img);
                const p = document.createElement("p");
                p.textContent = text;
                this.div.appendChild(p);
                document.body.appendChild(this.div);
            }

            update() {
                this.div.style.left = `${this.body.position.x -50}px`;
                this.div.style.top = `${this.body.position.y -100}px`;
                this.div.style.transform = `rotate(${this.body.angle}rad)`;
            }

            updateImage(imagePath, text) {
                this.div.querySelector("img").src = imagePath;
                this.div.querySelector("p").textContent = text;
            }
        }

        function mouseMoved(){
            if (dist(mouseX, mouseY, lastMouseX, lastMouseY) > 10){
                lastMouseX = mouseX;
                lastMouseY = mouseY;
            items.forEach((item) => {
                if(dist(mouseX, mouseY, item.body.position.x, item.body.position.y) > 100){
                    let forceMagnitude = 1;
                    Body.applyForce(
                        item.body, {
                            x: item.body.position.x, y: item.body.position.y
                        }, {
                            x: random(-forceMagnitude, forceMagnitude),
                            y: random(-forceMagnitude, forceMagnitude)
                        }
                    )
                }
            })
    }
}

    </script>
</body>
</html>